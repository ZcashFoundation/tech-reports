\documentclass{article}

\usepackage{amsthm, amsfonts, amssymb, amsmath, graphicx, cancel, framed}

\usepackage[hyphens]{url}
\urlstyle{same}


\title{Zcash Threat Model and Network Privacy Assessment}
\author{The Zcash Foundation}

\begin{document}

    \maketitle
\section{Introduction}

The amount of data leaked about individuals online is every growing.
Financial data in particular
provides a highly granular lens about personal daily habits, but securing one's
own financial privacy is difficult due to the value of tracking financial
habits for advertising purposes. Fortunately, Zcash ensures strong financial
privacy using zero-knowledge proofs along with randomization
techniques~\cite{zcash-spec} to
protect against data leakage that could lead to deanonymization of a payer or
recipient of Zcash. This approach ensures that the raw bytes of a
Zcash \emph{shielded} transaction cannot leak identifiable information about the
payer, payee, or amount.

However, an adversary observing the network over which Zcash clients and nodes
send transactions could perform passive or active attacks with the goal of
linking
users and their end recipients, even if that adversary cannot decrypt the Zcash
shielded transaction directly. Consequently, it is important to assess the
how such adversaries could be successful, what information is required in order
to perform such deanonymization attacks, and what such adversaries require to
do so.

In this technical report, we consider the above questions, and present the
threat model for Zcash more formally, assuming the use of shielded
transactions. We identify what constitutes sensitive information in the Zcash
ecosystem, what adversaries may exist, and enumerate the attack vectors that
such adversaries may employ. From this model, we then consider several
different network privacy mechanisms, and analyze the extent to which these
mechanisms improve the privacy and security of Zcash users. Finally, we lay out
several near-term and long-term recommendations for improvements.

\textit{Organization}.
TODO

\section{Background}

\subsection{Zcash Shielded Transactions}
\label{shielded}

While Zcash does allow for use of unshieleded transactions, in this technical
report we focus entirely on the threat model assuming the use of shielded
transactions. However, we will now briefly describe
the difference between the two transaction types.
As mentioned before, unshielded transactions are similar
to Bitcoin transactions, and expose the pseudonyms of the payer, payee, and the
amount paid. When this information is exposed to the network and persisted
indefinitely to the Blockchain, it is effectively “Twitter for your bank
account”.

Shielded transactions, on the other hand, expose what is essentially a “one
time pad” to a network observer. Because not only the transaction information
is encrypted, the encryption process itself is randomized such that two
transactions that have identical payers, payees, and transaction amounts result
in bytes that are completely indistinguishable from randomly-generated bytes.
In other words, given only a series of shielded transactions, an adversary
would not be able to gain enough information to distinguish any information
about the transaction paintext.


\subsection{Comparison of Zcash Privacy Expectations to Bitcoin}

While Zcash provides the ability to make shielded transactions to completely
hide the information contained within a transaction, users of Zcash can also
make non-shielded transactions. Because Zcash is a fork of Bitcoin,
non-shielded transactions consequently have effectively the same expectation of
privacy as plain Bitcoin transactions, which is not much. In this post, we’ll
evaluate the threat model for Zcash considering only shielded transactions.

While both Zcash and Bitcoin have future goals of
stable Tor integration and other network-privacy mechanisms, this routing via
an anonymity layer does not prevent attacks that examine the bytes of the
transaction itself. So unshielded transactions in Zcash and all Bitcoin
transactions leak information to a network observer, which can be exploited to
perform deanonymization attacks.

\section{Zcash Threat Model}

\subsection{Analysis of Sensitive Information Exposure}
As described in Section~\ref{shielded} an adversary could gain more information
about a shielded transaction by observing information exposed to the network.
Keeping this in mind, and assuming that a transaction is shielded, we now
review sensitive information that could be exposed and used for malicious
purposes by a adversary.
We divide these information leaks into \emph{in scope} to the Zcash threat
model, and \emph{out of scope}.

\subsubsection{In Scope}

\textbf{Learning the tuple (sender identity, transaction, receiver identity)}:
Specifically, this three-tuple allows for an adversary to link the fact that a
specific sender of Zcash made a payment to a specific receiver, even though the
amount of the payment is not disclosed. While the sender and receiver identity
is not exposed by the Zcash transaction itself, an adversary
could gain this information by observing the network or colluding
with one of the involved parties. For example, if the recipient is
malicious and colludes with a party that can link the sender to their
transaction, or if the recipient leaks to a provider which transaction they
are interested in, the sender and receiver could be linked to a particular
transaction. We consider exposure of this tuple to be in scope to our threat
model.

\textbf{Unique fingerprints of user habits}: By observing behavior of Zcash
transactions sent over the network, an adversary could start to build a
“fingerprint” of a user’s behavior, partially when using machine learning
algorithms to classify traffic. Information that is exposed in this
category includes the time of day that a transaction occurs, the frequency
of transactions, and even the route that a transaction passes through from
sender to receiver.

\subsubsection{Out of Scope}

\textbf{Learning the tuple (sender or receiver identity, receiver identity)}:
Note that a network observer can also gain a subset of sender/receiver
linkability information by
observing just a sender \emph{or} receiver's identity linked to a specific
transaction. We consider this use case to be out of scope to the threat model
of Zcash, as such
information---to the best of our assessment---simply leaks that the sender or
receiver is participating in sending and receiving Zcash, without any further
details. Consequently, we consider such an information leak to be out of scope.

\subsection{Adversarial Model}
TODO

\subsection{Attack Vectors}

\bibliographystyle{plain}
\bibliography{threat-model-network-privacy}

\end{document}
